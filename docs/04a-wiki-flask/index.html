
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>Creating a Flask App</title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://storage.googleapis.com/codelab-elements/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <google-codelab-analytics gaid="UA-49880327-14"></google-codelab-analytics>
  <google-codelab codelab-gaid=""
                  id="04a-wiki-flask"
                  title="Creating a Flask App"
                  environment="web"
                  feedback-link="">
    
      <google-codelab-step label="Overview" duration="0">
        <p>In this codelab, you&#39;ll create and run a &#34;hello world&#34; Flask application. You&#39;ll also practice collaborating in real-time with your teammates on a shared code repository.</p>
<h2 is-upgraded>Prerequisites</h2>
<ul>
<li>Cloud Shell</li>
<li>Git</li>
<li>Python</li>
<li>pytest</li>
</ul>
<h2 is-upgraded>What you&#39;ll need</h2>
<ul>
<li>Google account</li>
<li>GitLab account</li>
<li>Web browser (Google Chrome recommended)</li>
</ul>
<h2 class="checklist" is-upgraded>What you&#39;ll learn</h2>
<ul>
<li>Setup an empty Python repository</li>
<li>Create a &#34;hello world&#34; Flask application</li>
<li>Test a Flask application</li>
<li>Collaborate with teammates in real-time</li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="Setup your development environment" duration="0">
        <p>In this codelab, you&#39;ll be working with your project groups on your wiki implementation. Open the source code for the wiki in Cloud Shell Editor.</p>
<aside class="special"><p>All students should complete these steps.</p>
</aside>
<h2 is-upgraded>Open the repository in Cloud Shell Editor</h2>
<ol type="1">
<li>Click the pencil icon to open Cloud Shell Editor.</li>
<li>Navigate to the File -&gt; Open menu button.</li>
<li>Select the &#34;wiki&#34; directory which you created last week.</li>
</ol>


      </google-codelab-step>
    
      <google-codelab-step label="Create files needed for a Flask application" duration="0">
        <p>Next, add the &#34;boilerplate&#34; files needed for a Flask web application.</p>
<aside class="warning"><p>One student should complete these steps. Share your screen as you do so!</p>
</aside>
<h2 is-upgraded>Create Python files</h2>
<ol type="1">
<li>Create a file named &#34;wiki.py&#34;. <img alt="255d3fdea4b0fd0.png" style="width: 526.00px" src="img/255d3fdea4b0fd0.png"></li>
<li>So that you can test your code later, add code to the <code>wiki.py</code> file that prints &#34;Hello, World!&#34;.  <pre><code>print(&#34;Hello, World!&#34;)
</code></pre>
</li>
<li>Check that your Python environment is set up correctly by running the &#34;wiki.py&#34; file. Open a new terminal panel and run the Python command.</li>
</ol>
<pre>python wiki.py
</pre>
<h2 is-upgraded>Push your changes to GitLab</h2>
<p>If you successfully saw &#34;Hello, World!&#34; printed in the previous step, commit your changes and push them to GitLab so that your teammates can benefit from your work.</p>
<ol type="1">
<li>Add all the changes you&#39;ve made to the Git staging area.</li>
</ol>
<pre>git add .
</pre>
<p>The &#34;.&#34; says to add all files Git finds in the current directory or sub-directories.</p>
<ol type="1">
<li>See which files have been staged.</li>
</ol>
<pre>git status
</pre>
<p>You should see the following output:</p>
<pre>Changes to be committed:
  (use &#34;git rm --cached &lt;file&gt;...&#34; to unstage)

        new file:   wiki.py
</pre>
<p>If you see files you don&#39;t expect, check your &#34;.gitignore&#34; file to make sure it matches the recommended file at  <a href="https://github.com/github/gitignore/blob/master/Python.gitignore" target="_blank">https://github.com/github/gitignore/blob/master/Python.gitignore</a>.</p>
<ol type="1">
<li>Commit your changes.</li>
</ol>
<pre>git commit -m &#39;add wiki Python module&#39;
</pre>
<ol type="1">
<li>Push your changes to GitLab.</li>
</ol>
<pre>git push origin main
</pre>
<h2 is-upgraded>Verify that the package has been uploaded</h2>
<aside class="special"><p>All students should complete these steps.</p>
</aside>
<p>Download the code that your teammate just pushed and merge it with your local copy.</p>
<ol type="1">
<li>Download the code.</li>
</ol>
<pre>git fetch origin main
</pre>
<ol type="1">
<li>Merge it into your local copy.</li>
</ol>
<pre>git merge origin/main
</pre>
<p>If conflicts arise, refer to the  <a href="https://google-techx.github.io/software-development-studio/01c-conflicts/?index=/software-development-studio/#4" target="_blank">Handling Conflicts with Git codelab</a>.</p>
<ol type="1">
<li>Open the &#34;Terminal&#34; in Cloud Shell Editor.</li>
<li>Now, when you run your Python module, you&#39;ll see your code execute.</li>
</ol>
<pre>python wiki.py
</pre>


      </google-codelab-step>
    
      <google-codelab-step label="Setup a application requirements" duration="0">
        <p>Your wiki depends on more than just the Python built-in modules. In a team environment, it&#39;s important to document which packages your application depends on so that your teammates can also run the code.</p>
<p>By convention, Python developers create a file named &#34;requirements.txt&#34; containing the package names and versions of all the necessary packages to run your application.</p>
<aside class="warning"><p>One student (different from the previous) should complete these steps. Share your screen as you do so!</p>
</aside>
<ol type="1">
<li>Create a file called <code>requirements.txt</code> to indicate which packages your code depends on. <img alt="f98e639fa0aa64cd.png" style="width: 526.00px" src="img/f98e639fa0aa64cd.png"></li>
<li>Your wiki depends on Flask and pytest. Add these to the requirements.txt file you just created.</li>
</ol>
<pre>Flask==1.1.2
pytest==6.2.3
</pre>
<ol type="1">
<li>Install these packages with the pip install command from the Terminal panel.</li>
</ol>
<pre>pip install -r requirements.txt
</pre>
<p>Since you&#39;ve already installed the necessary packages in the  <a href="https://google-techx.github.io/software-development-studio/01a-cloud-shell/?index=/software-development-studio/#0" target="_blank">Using Python with Cloud Shell codelab</a>, you should see &#34;Requirement already satisfied&#34;.</p>
<h2 is-upgraded>Push your changes to GitLab</h2>
<p>Commit your changes and push them to GitLab so that your teammates can benefit from your work.</p>
<ol type="1">
<li>Add all the changes you&#39;ve made to the Git staging area.</li>
</ol>
<pre>git add .
</pre>
<p>The &#34;.&#34; says to add all files Git finds in the current directory or sub-directories.</p>
<ol type="1">
<li>See which files have been staged.</li>
</ol>
<pre>git status
</pre>
<p>You should see the following output:</p>
<pre>Changes to be committed:
  (use &#34;git rm --cached &lt;file&gt;...&#34; to unstage)

        new file:   requirements.txt
</pre>
<ol type="1">
<li>Commit your changes.</li>
</ol>
<pre>git commit -m &#39;add list of app dependencies&#39;
</pre>
<ol type="1">
<li>Push your changes to GitLab.</li>
</ol>
<pre>git push origin main
</pre>
<h2 is-upgraded>Verify that the requirements.txt file has been uploaded</h2>
<aside class="special"><p>All students should complete these steps.</p>
</aside>
<p>Download the code that your teammate just pushed and merge it with your local copy.</p>
<ol type="1">
<li>Download the code.</li>
</ol>
<pre>git fetch origin main
</pre>
<ol type="1">
<li>Merge it into your local copy.</li>
</ol>
<pre>git merge origin/main
</pre>
<ol type="1">
<li>Open the &#34;Terminal&#34; in Cloud Shell Editor.</li>
<li>Install the necessary packages.</li>
</ol>
<pre>pip install -r requirements.txt
</pre>


      </google-codelab-step>
    
      <google-codelab-step label="Create a test file" duration="0">
        <p>It&#39;s good software engineering practice to have tests. Create a test file for your code.</p>
<aside class="warning"><p>One student (different from the previous) should complete these steps. Share your screen as you do so!</p>
</aside>
<ol type="1">
<li>Create a file named &#34;wiki_test.py&#34;. <img alt="7728f9c22446c5ab.png" style="width: 526.00px" src="img/7728f9c22446c5ab.png"></li>
<li>Add a test that checks that you can import the &#34;wiki.py&#34; file from test code.</li>
</ol>
<pre>import wiki


def test_import():
    assert wiki is not None
</pre>
<ol type="1">
<li>In a Terminal panel, run this test with the pytest command.</li>
</ol>
<pre>pytest wiki_test.py
</pre>
<p>You should see that 1 test has passed.</p>
<h2 is-upgraded>Push your changes to GitLab</h2>
<p>Commit your changes and push them to GitLab so that your teammates can benefit from your work.</p>
<ol type="1">
<li>Add all the changes you&#39;ve made to the Git staging area.</li>
</ol>
<pre>git add .
</pre>
<p>The &#34;.&#34; says to add all files Git finds in the current directory or sub-directories.</p>
<ol type="1">
<li>See which files have been staged.</li>
</ol>
<pre>git status
</pre>
<p>You should see the following output:</p>
<pre>Changes to be committed:
  (use &#34;git rm --cached &lt;file&gt;...&#34; to unstage)

        new file:   wiki_test.py
</pre>
<ol type="1">
<li>Commit your changes.</li>
</ol>
<pre>git commit -m &#39;add list of app dependencies&#39;
</pre>
<ol type="1">
<li>Push your changes to GitLab.</li>
</ol>
<pre>git push origin main
</pre>
<h2 is-upgraded>Verify that the test file has been uploaded</h2>
<aside class="special"><p>All students should complete these steps.</p>
</aside>
<p>Download the code that your teammate just pushed and merge it with your local copy.</p>
<ol type="1">
<li>Download the code.</li>
</ol>
<pre>git fetch origin main
</pre>
<ol type="1">
<li>Merge it into your local copy.</li>
</ol>
<pre>git merge origin/main
</pre>
<ol type="1">
<li>Open the &#34;Terminal&#34; in Cloud Shell Editor.</li>
<li>Run the test file.</li>
</ol>
<pre>pytest wiki_test.py
</pre>


      </google-codelab-step>
    
      <google-codelab-step label="Setup a Flask application" duration="0">
        <p>Create a &#34;Flask&#34; application to be the web server for your wiki.</p>
<aside class="warning"><p>One student (different from the previous) should complete these steps. Share your screen as you do so!</p>
</aside>
<ol type="1">
<li>Replace the text in the <code>wiki.py</code> file with the code to create a Flask server.</li>
</ol>
<pre>from flask import Flask

app = Flask(__name__)

@app.route(&#34;/&#34;)
def main():
    return &#34;Hello, World!\n&#34;
</pre>
<ol type="1">
<li>In a Terminal panel, run the Flask server with these three commands.</li>
</ol>
<pre>export FLASK_APP=wiki
export FLASK_ENV=development
flask run -p 8080
</pre>
<ol type="1">
<li>Open a second Terminal panel (keeping the first one open).</li>
<li>In the second Terminal panel, use cURL to test your local web server.</li>
</ol>
<pre>curl localhost:8080
</pre>
<p>You should see &#34;Hello, World!&#34; printed.</p>
<ol type="1">
<li>In the first Terminal panel, press the &#34;Ctrl + C&#34; shortcut to stop Flask from running. (Note: Control also on macOS, not ⌘)</li>
</ol>
<h2 is-upgraded>Push your changes to GitLab</h2>
<p>Commit your changes and push them to GitLab so that your teammates can benefit from your work.</p>
<ol type="1">
<li>Add all the changes you&#39;ve made to the Git staging area.</li>
</ol>
<pre>git add .
</pre>
<p>The &#34;.&#34; says to add all files Git finds in the current directory or sub-directories.</p>
<ol type="1">
<li>See which files have been staged.</li>
</ol>
<pre>git status
</pre>
<p>You should see the following output:</p>
<pre>Changes to be committed:
  (use &#34;git rm --cached &lt;file&gt;...&#34; to unstage)

        modified:   wiki.py
</pre>
<ol type="1">
<li>Commit your changes.</li>
</ol>
<pre>git commit -m &#39;create Hello World Flask application&#39;
</pre>
<ol type="1">
<li>Push your changes to GitLab.</li>
</ol>
<pre>git push origin main
</pre>
<h2 is-upgraded>Verify that the application has been uploaded</h2>
<aside class="special"><p>All students should complete these steps.</p>
</aside>
<p>Download the code that your teammate just pushed and merge it with your local copy.</p>
<ol type="1">
<li>Download the code.</li>
</ol>
<pre>git fetch origin main
</pre>
<ol type="1">
<li>Merge it into your local copy.</li>
</ol>
<pre>git merge origin/main
</pre>
<ol type="1">
<li>Open the &#34;Terminal&#34; in Cloud Shell Editor.</li>
<li>In the Terminal panel, run the Flask server with these three commands.</li>
</ol>
<pre>export FLASK_APP=wiki
export FLASK_ENV=development
flask run -p 8080
</pre>
<ol type="1">
<li>Open a second Terminal panel (keeping the first one open).</li>
<li>In the second Terminal panel, use cURL to test your local web server.</li>
</ol>
<pre>curl localhost:8080
</pre>
<p>You should see &#34;Hello, World!&#34; printed.</p>
<ol type="1">
<li>In the first Terminal panel, press the &#34;Ctrl + C&#34; shortcut to stop Flask from running. (Note: Control also on macOS, not ⌘)</li>
</ol>


      </google-codelab-step>
    
      <google-codelab-step label="Create a script to run Flask" duration="0">
        <p>Since it can be hard to remember the three commands to start the Flask server, create a script with these commands.</p>
<aside class="warning"><p>One student (different from the previous) should complete these steps. Share your screen as you do so!</p>
</aside>
<ol type="1">
<li>Create a new file named <code>run-flask.sh</code> in the root directory of the repository. <img alt="8c964170b9d9100e.png" style="width: 526.00px" src="img/8c964170b9d9100e.png"></li>
<li>Add the three commands, as well as a &#34;shebang&#34; that indicates this file is a script.  <pre><code>#!/usr/bin/env bash
export FLASK_APP=wiki
export FLASK_ENV=development
flask run -p 8080
</code></pre>
</li>
<li>In the Terminal panel, make the script &#34;executable&#34; by running the <code>chmod</code> command.</li>
</ol>
<pre>chmod +x run-flask.sh
</pre>
<h2 is-upgraded>Try the server</h2>
<p>Cloud Shell provides a web preview feature, which allows you to access your Flask server from a web browser. It prevents access from anyone but you by using your Google credentials.</p>
<p>Run the server and use the Cloud Shell web preview to access it.</p>
<ol type="1">
<li>In a Terminal panel, run the run-flask.sh script you just created.</li>
</ol>
<pre>./run-flask.sh
</pre>
<ol type="1">
<li>In the top-right corner of the window, click the web preview  <img alt="b1d7918d5ed8a1f8.png" style="width: 38.00px" src="img/b1d7918d5ed8a1f8.png"> button and select &#34;Preview on port 8080&#34;. <img alt="52aeb3163b0633a6.png" style="width: 356.00px" src="img/52aeb3163b0633a6.png"></li>
<li>In the browser window that opens, you may have to select your Google account. Select the same one that you are using for Cloud Shell.</li>
<li>Verify that you see &#34;Hello, World!&#34; printed in the browser window.</li>
<li>Press &#34;Ctrl + C&#34; in the Terminal panel to stop the Flask server.</li>
</ol>
<h2 is-upgraded>Push your changes to GitLab</h2>
<p>If you successfully saw &#34;Hello, World!&#34; printed in the previous step, commit your changes and push them to GitLab.</p>
<ol type="1">
<li>Add all the changes you&#39;ve made to the Git staging area.</li>
</ol>
<pre>git add .
</pre>
<p>The &#34;.&#34; says to add all files Git finds in the current directory or sub-directories.</p>
<ol type="1">
<li>See which files have been staged.</li>
</ol>
<pre>git status
</pre>
<p>You should see the following output:</p>
<pre>Changes to be committed:
  (use &#34;git reset HEAD &lt;file&gt;...&#34; to unstage)

        new file:   run-flask.sh
</pre>
<ol type="1">
<li>Commit your changes.</li>
</ol>
<pre>git commit -m &#39;add command to run Flask server&#39;
</pre>
<ol type="1">
<li>Push your changes to GitLab.</li>
</ol>
<pre>git push origin main
</pre>
<h2 is-upgraded>Verify that the Flask server has been uploaded</h2>
<aside class="special"><p>All students should complete these steps.</p>
</aside>
<p>Download the code that your teammate just pushed and merge it with your local copy.</p>
<ol type="1">
<li>Download the code.</li>
</ol>
<pre>git fetch origin main
</pre>
<ol type="1">
<li>Merge it into your local copy.</li>
</ol>
<pre>git merge origin/main
</pre>
<ol type="1">
<li>Open the &#34;Terminal&#34; in Cloud Shell Editor.</li>
<li>Run the Flask server.</li>
</ol>
<pre>./run-flask.sh
</pre>
<ol type="1">
<li>In the top-right corner of the window, click the web preview  <img alt="b1d7918d5ed8a1f8.png" style="width: 38.00px" src="img/b1d7918d5ed8a1f8.png"> button and select &#34;Preview on port 8080&#34;.</li>
<li>Verify that you see &#34;Hello, World!&#34; printed in the browser window.</li>
<li>Press &#34;Ctrl + C&#34; in the Terminal panel to stop the Flask server.</li>
</ol>


      </google-codelab-step>
    
      <google-codelab-step label="Add tests for Flask homepage" duration="0">
        <p>It&#39;s important to add automated tests for all application code to ensure that your project continues to work as expected after making code changes. This is especially important when there are multiple contributors to the project.</p>
<p>Add tests to check that the Flask application is working properly.</p>
<aside class="warning"><p>One student (different from the previous) should complete these steps. Share your screen as you do so!</p>
</aside>
<ol type="1">
<li>Edit the &#34;wiki_test.py&#34; file and add a test that checks for &#34;Hello, World!&#34; in the home page.</li>
</ol>
<pre>import pytest

import wiki


@pytest.fixture
def client():
    wiki.app.config[&#34;TESTING&#34;] = True

    with wiki.app.test_client() as client:
        yield client


def test_import():
    assert wiki is not None


def test_homepage(client):
    resp = client.get(&#34;/&#34;)
    assert resp.status_code == 200
    assert b&#34;Hello, World!\n&#34; in resp.data
</pre>
<p>The &#34;client&#34; function is a  <a href="https://docs.pytest.org/en/6.2.x/fixture.html" target="_blank">pytest fixture</a> that creates a  <a href="https://flask.palletsprojects.com/en/1.1.x/testing/" target="_blank">Flask test client</a> ( <a href="https://flask.palletsprojects.com/en/1.1.x/api/#flask.testing.FlaskClient" target="_blank">api reference</a>,  <a href="https://werkzeug.palletsprojects.com/en/2.0.x/test/#werkzeug.test.Client" target="_blank">additional reference</a>). This allows you to add a &#34;client&#34; argument to your tests, which you can use to make requests to your Flask application.</p>
<p>The result of calling the &#34;client.get()&#34; method is a  <a href="https://flask.palletsprojects.com/en/1.1.x/api/#response-objects" target="_blank">Response</a> object, which contains useful properties such as &#34;status_code&#34; and &#34;data&#34;. The assertions check that these are the expected values.</p>
<ol type="1">
<li>From a Terminal panel, run the test with the pytest command.</li>
</ol>
<pre>pytest .
</pre>
<ol type="1">
<li>Verify that the tests have passed.</li>
</ol>
<h2 is-upgraded>Push your changes to GitLab</h2>
<p>If the test passed in the previous step, commit your changes and push them to GitLab.</p>
<ol type="1">
<li>Add all the changes you&#39;ve made to the Git staging area.</li>
</ol>
<pre>git add .
</pre>
<ol type="1">
<li>See which files have been staged.</li>
</ol>
<pre>git status
</pre>
<p>You should see the following output:</p>
<pre>Changes to be committed:
  (use &#34;git reset HEAD &lt;file&gt;...&#34; to unstage)

        modified:   wiki_test.py
</pre>
<ol type="1">
<li>Commit your changes.</li>
</ol>
<pre>git commit -m &#39;add test for home page&#39;
</pre>
<ol type="1">
<li>Push your changes to GitLab.</li>
</ol>
<pre>git push origin main
</pre>
<h2 is-upgraded>Verify that the tests have been uploaded</h2>
<aside class="special"><p>All students should complete these steps.</p>
</aside>
<p>Download the code that your teammate just pushed and merge it with your local copy.</p>
<ol type="1">
<li>Download the code.</li>
</ol>
<pre>git fetch origin main
</pre>
<ol type="1">
<li>Merge it into your local copy.</li>
</ol>
<pre>git merge origin/main
</pre>
<ol type="1">
<li>Open the &#34;Terminal&#34; in Cloud Shell Editor.</li>
<li>Run the test with the pytest command.</li>
</ol>
<pre>pytest .
</pre>
<ol type="1">
<li>Verify that the test has passed.</li>
</ol>


      </google-codelab-step>
    
      <google-codelab-step label="Finishing up" duration="0">
        <p>Double-check that the code has been pushed by viewing the code on GitLab.</p>
<p>You now have the necessary files in place to continue developing your wiki. In the Milestone 1 description, you will receive additional instructions about the expected next steps.</p>
<p>Continue to work together as a group, pushing your changes when you&#39;ve added a feature, and pulling your teammates&#39; changes often.</p>


      </google-codelab-step>
    
  </google-codelab>

  <script src="https://storage.googleapis.com/codelab-elements/native-shim.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/custom-elements.min.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/prettify.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/codelab-elements.js"></script>
  <script src="//support.google.com/inapp/api.js"></script>

</body>
</html>
